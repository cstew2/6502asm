#ifndef __6502_H__
#define __6502_H__

#include <stdint.h>

const char COMMENT_CHAR1 = '#';
const char COMMENT_CHAR2 = ';';

const char SEPERATOR_CHAR = ',';

const char PAREN_L_CHAR = '(';
const char PAREN_R_CHAR = ')';

const char HEX_CHAR = '$';
const char BIN_CHAR = '%';
const char IMMEDIATE_CHAR = '#';

const char LABEL_CHAR = ':';
const char DIRECTIVE_CHAR = '.';

const char EQUALS_CHAR = '=';

enum directives {
	START,
	END,
	ALIGN,
	ORIGIN,
	BYTE,
	WORD,
	SEGMENT,
	INCLUDE
};

struct directive_defs {
	enum directives directive;
	const char *string;
};

const int DIRECTIVE_SIZE = 8;
const struct directive_defs ASM_DIRECTIVES[8] = {
	{START,   "START"},
	{END,     "END"},
	{ALIGN,   "ALIGN"},
	{ORIGIN,  "ORIGIN"},
	{BYTE,    "BYTE"},
	{WORD,    "WORD"},
	{SEGMENT, "SEGMENT"},
	{INCLUDE, "INCLUDE"}
};

enum addressing_modes{
	NONE,
	IMPLIED,
	IMMEDIATE,
	ABSOLUTE,
	ZERO_PAGE,
	RELATIVE,
	ABSOLUTE_X,
	ABSOLUTE_Y,
	ZERO_PAGE_X,
	ZERO_PAGE_Y,
	INDIRECT,
	INDIRECT_X,
	INDIRECT_Y
};

const int REGISTER_SIZE = 3;
const char * const REGISTER_NAMES[3] = {
	"A",
	"X",
	"Y"
};

const int OPCODE_MNEMOIC_SIZE = 76;
const char * const OPCODE_MNEMONICS[76] = {
	//arithmatic and logical opcodes
	"ORA",
	"AND",
	"EOR",
	"ADC",
	"SBC",
	"CMP",
	"CPX",
	"CPY",
	"DEC",
	"DEX",
	"DEY",
	"INC",
	"INX",
	"INY",
	"ASL",
	"ROL",
	"LSR",
	"ROR",

	//data opcodes
	"LDA",
	"STA",
	"LDX",
	"STX",
	"LDY",
	"STY",
	"TAX",
	"TXA",
	"TAY",
	"TYA",
	"TSX",
	"TXS",
	"PLA",
	"PHA",
	"PLP",
	"PHP",

	//jump and flag opcodes
	"BPL",
	"BMI",
	"BVC",
	"BCC",
	"BCS",
	"BNE",
	"BEQ",
	"BRK",
	"RTI",
	"JSR",
	"RTS",
	"JMP",
	"BIT",
	"CLC",
	"SEC",
	"CLD",
	"SED",
	"CLI",
	"SEI",
	"CLV",
	"NOP",

	//illegal opcodes
	"SLO",
	"RLA",
	"SRE",
	"RRA",
	"SAX",
	"LAX",
	"DCP",
	"ISC",
	"ANC",
	"ALR",
	"ARR",
	"XAA",
	"LAX",
	"AXS",
	"SBC",
	"AHX",
	"SHY",
	"SHX",
	"TAS",
	"LAS",
	"KIL"
};

struct opcode_def {
	uint8_t opcode;
	const char *mnemonic;
	int size;
	int cycles;
	enum addressing_modes mode;
};

const struct opcode_def asm_opcodes[] = {
        {0x00, "BRK",  2,  7, NONE},
	{0x01, "ORA",  2,  6, INDIRECT_X},
	{0x02, "KIL", -1, -1, NONE},
	{0x03, "SLO",  2,  8, INDIRECT_X},
	{0x04, "NOP",  2,  3, ZERO_PAGE},
	{0x05, "ORA",  2,  3, ZERO_PAGE},
	{0x06, "ASL",  2,  5, ZERO_PAGE},
	{0x07, "SLO",  2,  5, ZERO_PAGE},
	{0x08, "PHP",  1,  3, IMPLIED},
	{0x09, "ORA",  2,  2, IMMEDIATE},
	{0x0A, "ASL",  1,  2, IMPLIED},
	{0x0B, "ANC",  2,  2, IMMEDIATE},
	{0x0C, "NOP",  3,  4, ABSOLUTE},
	{0x0D, "ORA",  3,  4, ABSOLUTE},
	{0x0E, "ASL",  3,  6, ABSOLUTE},
	{0x0F, "SLO",  3,  6, ABSOLUTE},
			
	{0x10, "BPL",  2,  3, RELATIVE},
	{0x11, "ORA",  2,  5, INDIRECT_Y},
	{0x12, "KIL", -1,  8, NONE},
	{0x13, "SLO",  2,  4, INDIRECT_Y},
	{0x14, "NOP",  2,  4, ZERO_PAGE_X},
	{0x15, "ORA",  2,  6, ZERO_PAGE_X},
	{0x16, "ASL",  2,  6, ZERO_PAGE_X},
	{0x17, "SLO",  2,  2, ZERO_PAGE_X},
	{0x18, "CLC",  1,  2, IMPLIED},
	{0x19, "ORA",  3,  4, ABSOLUTE_Y},
	{0x1A, "NOP",  1,  2, NONE},
	{0x1B, "SLO",  3,  7, ABSOLUTE_Y},
	{0x1C, "NOP",  3,  4, ABSOLUTE_X},
	{0x1D, "ORA",  3,  4, ABSOLUTE_X},
	{0x1E, "ASL",  3,  7, ABSOLUTE_X},
	{0x1F, "SLO",  3,  7, ABSOLUTE_X},
			
	{0x20, "JSR",  3,  6, ABSOLUTE},
	{0x21, "AND",  2,  6, INDIRECT_X},
	{0x22, "KIL", -1, -1, NONE},
	{0x23, "RLA",  2,  8, INDIRECT_X},
	{0x24, "BIT",  2,  3, ZERO_PAGE},
	{0x25, "AND",  2,  3, ZERO_PAGE},
	{0x26, "ROL",  2,  5, ZERO_PAGE},
	{0x27, "RLA",  2,  5, ZERO_PAGE},
	{0x28, "PLP",  1,  4, IMPLIED},
	{0x29, "AND",  2,  2, IMMEDIATE},
	{0x2A, "ROL",  1,  2, IMPLIED},
	{0x2B, "ANC",  2,  2, IMMEDIATE},
	{0x2C, "BIR",  3,  4, ABSOLUTE},
	{0x2D, "AND",  3,  4, ABSOLUTE},
	{0x2E, "ROL",  3,  6, ABSOLUTE},
	{0x2F, "RLA",  3,  6, ABSOLUTE},
			
	{0x30, "BMI",  2,  2, RELATIVE},
	{0x31, "AND",  2,  5, INDIRECT_Y},
	{0x32, "KIL", -1, -1, NONE},
	{0x33, "RLA",  2,  8, INDIRECT_Y},
	{0x34, "NOP",  2,  4, ZERO_PAGE_X},
	{0x35, "AND",  2,  4, ZERO_PAGE_X},
	{0x36, "ROL",  2,  6, ZERO_PAGE_X},
	{0x37, "RLA",  2,  6, ZERO_PAGE_X},
	{0x38, "SEC",  1,  2, IMPLIED},
	{0x39, "AND",  3,  4, ABSOLUTE_Y},
	{0x3A, "NOP",  1,  2, NONE},
	{0x3B, "RLA",  3,  7, ABSOLUTE_Y},
	{0x3C, "NOP",  3,  4, ABSOLUTE_X},
	{0x3D, "AND",  3,  4, ABSOLUTE_X},
	{0x3E, "ROL",  3,  7, ABSOLUTE_X},
	{0x3F, "RLA",  3,  7, ABSOLUTE_X},
			
	{0x40, "RTI",  1,  6, IMPLIED},
	{0x41, "EOR",  2,  6, INDIRECT_X},
	{0x42, "KIL", -1, -1, NONE},
	{0x43, "SRE",  2,  8, INDIRECT_X},
	{0x44, "NOP",  2,  3, ZERO_PAGE},
	{0x45, "EOR",  2,  3, ZERO_PAGE},
	{0x46, "LSR",  2,  5, ZERO_PAGE},
	{0x47, "SRE",  2,  5, ZERO_PAGE},
	{0x48, "PHA",  1,  3, IMPLIED},
	{0x49, "EOR",  2,  2, IMMEDIATE},
	{0x4A, "LSR",  1,  2, IMPLIED},
	{0x4B, "ALR",  2,  2, IMMEDIATE},
	{0x4C, "JMP",  3,  3, ABSOLUTE},
	{0x4D, "EOR",  3,  4, ABSOLUTE},
	{0x4E, "LSR",  3,  6, ABSOLUTE},
	{0x4F, "SRE",  3,  6, ABSOLUTE},
			
	{0x50, "BVC",  2,  3, RELATIVE},
	{0x51, "EOR",  1,  5, INDIRECT_X},
	{0x52, "KIL", -1, -1, NONE},
	{0x53, "SRE",  2,  8, INDIRECT_Y},
	{0x54, "NOP",  2,  4, ZERO_PAGE_X},
	{0x55, "EOR",  2,  4, ZERO_PAGE_X},
	{0x56, "LSR",  2,  6, ZERO_PAGE_X},
	{0x57, "SRE",  2,  6, ZERO_PAGE_X},
	{0x58, "CLI",  1,  2, IMPLIED},
	{0x59, "EOR",  3,  4, ABSOLUTE_Y},
	{0x5A, "NOP",  1,  2, NONE},
	{0x5B, "SRE",  3,  7, ABSOLUTE_Y},
	{0x5C, "NOP",  3,  4, ABSOLUTE_X},
	{0x5D, "EOR",  3,  4, ABSOLUTE_X},
	{0x5E, "LSR",  3,  7, ABSOLUTE_X},
	{0x5F, "SRE",  3,  7, ABSOLUTE_X},
			
	{0x60, "RTS",  1,  6, IMPLIED},
	{0x61, "ADC",  2,  6, INDIRECT_X},
	{0x62, "KIL", -1, -1, NONE},
	{0x63, "RRA",  2,  8, INDIRECT_X},
	{0x64, "NOP",  2,  3, ZERO_PAGE},
	{0x65, "ADC",  2,  3, ZERO_PAGE},
	{0x66, "ROR",  2,  5, ZERO_PAGE},
	{0x67, "RRA",  2,  5, ZERO_PAGE},
	{0x68, "PLA",  1,  4, IMPLIED},
	{0x69, "ADC",  2,  2, IMMEDIATE},
	{0x6A, "ROR",  1,  2, IMPLIED},
	{0x6B, "ARR",  2,  2, IMMEDIATE},
	{0x6C, "JMP",  3,  5, INDIRECT},
	{0x6D, "ADC",  3,  4, ABSOLUTE},
	{0x6E, "ROR",  3,  6, ABSOLUTE},
	{0x6F, "RRA",  3,  6, ABSOLUTE},
			
	{0x70, "BVS",  2,  2, RELATIVE},
	{0x71, "ADC",  2,  5, INDIRECT_Y},
	{0x72, "KIL", -1, -1, NONE},
	{0x73, "RRA",  2,  8, INDIRECT_Y},
	{0x74, "NOP",  2,  4, ZERO_PAGE_X},
	{0x75, "ADC",  2,  4, ZERO_PAGE_X},
	{0x76, "ROR",  2,  6, ZERO_PAGE_X},
	{0x77, "RRA",  2,  6, ZERO_PAGE_X},
	{0x78, "SEI",  1,  2, IMPLIED},
	{0x79, "ADC",  3,  4, ABSOLUTE_Y},
	{0x7A, "NOP",  1,  2, NONE},
	{0x7B, "RRA",  3,  7, ABSOLUTE_Y},
	{0x7C, "NOP",  3,  4, ABSOLUTE_X},
	{0x7D, "ADC",  3,  4, ABSOLUTE_X},
	{0x7E, "ROR",  3,  7, ABSOLUTE_X},
	{0x7F, "RRA",  3,  7, ABSOLUTE_X},
			
	{0x80, "NOP",  2,  2, IMMEDIATE},
	{0x81, "STA",  2,  6, ZERO_PAGE_X},
	{0x82, "NOP",  2,  2, IMMEDIATE},
	{0x83, "SAX",  2,  6, ZERO_PAGE_X},
	{0x84, "STY",  2,  3, ZERO_PAGE},
	{0x85, "STA",  2,  3, ZERO_PAGE},
	{0x86, "STX",  2,  3, ZERO_PAGE},
	{0x87, "SAX",  2,  3, ZERO_PAGE},
	{0x88, "DEY",  1,  2, IMPLIED},
	{0x89, "NOP",  2,  2, IMMEDIATE},
	{0x8A, "TXA",  1,  2, IMPLIED},
	{0x8B, "XAA",  2,  2, IMMEDIATE},
	{0x8C, "STY",  3,  4, ABSOLUTE},
	{0x8D, "STA",  3,  4, ABSOLUTE},
	{0x8E, "STX",  3,  4, ABSOLUTE},
	{0x8F, "SAX",  3,  4, ABSOLUTE},
			
	{0x90, "BCC",  2,  3, RELATIVE},
	{0x91, "STA",  2,  6, INDIRECT_Y},
	{0x92, "KIL", -1, -1, NONE},
	{0x93, "AHX",  2,  6, INDIRECT_Y},
	{0x94, "STY",  2,  4, ZERO_PAGE_X},
	{0x95, "STA",  2,  4, ZERO_PAGE_X},
	{0x96, "STX",  2,  4, ZERO_PAGE_X},
	{0x97, "SAX",  2,  4, ZERO_PAGE_X},
	{0x98, "TYA",  1,  2, IMPLIED},
	{0x99, "STA",  3,  5, ABSOLUTE_Y},
	{0x9A, "TXS",  1,  2, IMPLIED},
	{0x9B, "TAS",  1,  5, ABSOLUTE_Y},
	{0x9C, "SHY",  3,  5, ABSOLUTE_X},
	{0x9D, "STA",  3,  5, ABSOLUTE_X},
	{0x9E, "SHX",  3,  5, ABSOLUTE_Y},
	{0x9F, "AHX",  3,  5, ABSOLUTE_Y},
			
	{0xA0, "LDY",  2,  2, IMMEDIATE},
	{0xA1, "LDA",  2,  6, INDIRECT_X},
	{0xA2, "LDX",  2,  2, IMMEDIATE},
	{0xA3, "LAX",  2,  6, INDIRECT_X},
	{0xA4, "LDY",  2,  3, ZERO_PAGE},
	{0xA5, "LDA",  2,  3, ZERO_PAGE},
	{0xA6, "LDX",  2,  3, ZERO_PAGE},
	{0xA7, "LAX",  2,  3, ZERO_PAGE},
	{0xA8, "TAY",  1,  2, IMPLIED},
	{0xA9, "LDA",  2,  2, IMMEDIATE},
	{0xAA, "TAX",  1,  2, IMPLIED},
	{0xAB, "LAX",  2,  2, IMMEDIATE},
	{0xAC, "LDY",  3,  4, ABSOLUTE},
	{0xAD, "LDA",  3,  4, ABSOLUTE},
	{0xAE, "LDX",  3,  4, ABSOLUTE},
	{0xAF, "LAX",  3,  4, ABSOLUTE},
	
	{0xB0, "BCS",  2,  2, RELATIVE},
	{0xB1, "LDA",  2,  5, INDIRECT_Y},
	{0xB2, "KIL", -1, -1, NONE},
	{0xB3, "LAX",  2,  5, INDIRECT_Y},
	{0xB4, "LDY",  2,  4, ZERO_PAGE_X},
	{0xB5, "LDA",  2,  4, ZERO_PAGE_X},
	{0xB6, "LDX",  2,  4, ZERO_PAGE_Y},
	{0xB7, "LAX",  2,  4, ZERO_PAGE_Y},
	{0xB8, "CLV",  1,  2, IMPLIED},
	{0xB9, "LDA",  3,  4, ABSOLUTE_Y},
	{0xBA, "TXS",  1,  2, IMPLIED},
	{0xBB, "LAS",  3,  4, ABSOLUTE_Y},
	{0xBC, "LDY",  3,  4, ABSOLUTE_X},
	{0xBD, "LDA",  3,  4, ABSOLUTE_X},
	{0xBE, "LDX",  3,  4, ABSOLUTE_Y},
	{0xBF, "LAX",  3,  4, ABSOLUTE_Y},
			
	{0xC0, "CPY",  2,  2, IMMEDIATE},
	{0xC1, "CMP",  2,  6, INDIRECT_X},
	{0xC2, "NOP",  2,  2, IMMEDIATE},
	{0xC3, "DCP",  2,  8, INDIRECT_X},
	{0xC4, "CPY",  2,  4, ZERO_PAGE},
	{0xC5, "CMP",  2,  4, ZERO_PAGE},
	{0xC6, "DEC",  2,  5, ZERO_PAGE},
	{0xC7, "DCP",  2,  5, ZERO_PAGE},
	{0xC8, "INY",  1,  2, IMPLIED},
	{0xC9, "CMP",  2,  2, IMMEDIATE},
	{0xCA, "DEX",  1,  2, IMPLIED},
	{0xCB, "AXS",  2,  2, IMMEDIATE},
	{0xCC, "CPY",  3,  4, ABSOLUTE},
	{0xCD, "CMP",  3,  4, ABSOLUTE},
	{0xCE, "DEC",  3,  6, ABSOLUTE},
	{0xCF, "DCP",  3,  6, ABSOLUTE},
			
	{0xD0, "BNE",  2,  3, RELATIVE},
	{0xD1, "CMP",  2,  5, INDIRECT_Y},
	{0xD2, "KIL", -1, -1, NONE},
	{0xD3, "DCP",  2,  8, INDIRECT_Y},
	{0xD4, "NOP",  2,  4, ZERO_PAGE_X},
	{0xD5, "CMP",  2,  4, ZERO_PAGE_X},
	{0xD6, "DEC",  2,  6, ZERO_PAGE_X},
	{0xD7, "DCP",  2,  6, ZERO_PAGE_X},
	{0xD8, "CLD",  1,  2, IMPLIED},
	{0xD9, "CMP",  3,  4, ABSOLUTE_Y},
	{0xDA, "NOP",  1,  2, NONE},
	{0xDB, "DCP",  3,  7, ABSOLUTE_Y},
	{0xDC, "NOP",  3,  4, ABSOLUTE_X},
	{0xDD, "CMP",  3,  4, ABSOLUTE_X},
	{0xDE, "DEC",  3,  7, ABSOLUTE_X},
	{0xDF, "DCP",  3,  7, ABSOLUTE_X},
			
	{0xE0, "CPX",  2,  2, IMMEDIATE},
	{0xE1, "SBC",  2,  6, INDIRECT_X},
	{0xE2, "NOP",  2,  2, IMMEDIATE},
	{0xE3, "ISC",  2,  8, INDIRECT_X},
	{0xE4, "CPX",  2,  3, ZERO_PAGE},
	{0xE5, "SBC",  2,  3, ZERO_PAGE},
	{0xE6, "INC",  2,  5, ZERO_PAGE},
	{0xE7, "ISC",  2,  5, ZERO_PAGE},
	{0xE8, "INX",  1,  2, IMPLIED},
	{0xE9, "SBC",  2,  2, IMMEDIATE},
	{0xEA, "NOP",  1,  2, NONE},
	{0xEB, "SBC",  2,  2, IMMEDIATE},
	{0xEC, "CPX",  3,  4, ABSOLUTE},
	{0xED, "SBC",  3,  4, ABSOLUTE},
	{0xEE, "INC",  3,  6, ABSOLUTE},
	{0xEF, "ISC",  3,  6, ABSOLUTE},
			
	{0xF0, "BEQ",  2,  2, RELATIVE},
	{0xF1, "SBC",  2,  5, INDIRECT_Y},
	{0xF2, "KIL", -1, -1, NONE},
	{0xF3, "ISC",  2,  8, INDIRECT_Y},
	{0xF4, "NOP",  2,  4, ZERO_PAGE_X},
	{0xF5, "SBC",  2,  4, ZERO_PAGE_X},
	{0xF6, "INC",  2,  6, ZERO_PAGE_X},
	{0xF7, "ISC",  2,  6, ZERO_PAGE_X},
	{0xF8, "SED",  1,  2, IMPLIED},
	{0xF9, "SBC",  3,  4, ABSOLUTE_Y},
	{0xFA, "NOP",  1,  2, NONE},
	{0xFB, "ISC",  3,  7, ABSOLUTE_Y},
	{0xFC, "NOP",  3,  4, ABSOLUTE_X},
	{0xFD, "SBC",  3,  4, ABSOLUTE_X},
	{0xFE, "INC",  3,  7, ABSOLUTE_X},
	{0xFF, "ISC",  3,  7, ABSOLUTE_X}
};

#endif
